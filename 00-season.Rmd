# (PART) Season

# Schedule 

```{r}

dt_season_show <- dt_season[course=='full' & !(is_champ), .(`Race #` = race_number,
                            Date = date_ymd,
                            `Event type` = race_type,
                            cancelled,
                            cancelled_reason,
                            have_results)]

dt_season_show[(cancelled), Note:= paste0("Cancelled due to ", cancelled_reason)]
dt_season_show[!(cancelled) & !(have_results), Note := "webscorer data not available"]
dt_season_show[is.na(Note), Note := ""]

col_ref_hide <- which(!(names(dt_season_show) %in% c("Race #","Date","Event type","Note")))-1 # columns are indexed from 0 - row name?


# knitr::kable(dt_season_show[, .(`Race #`,
#                                 Date,
#                                 `Event type`,
#                                 Note
#                                 )])

datatable_std(dt_season_show,col_ref_hide)
```


# Participation - Total {#participation-total}

```{r}
n_entries_all_season <- nrow(dt_all_long[(started) & part == "Swim"])
```


There have been `r prettyNum(n_entries_all_season, big.mark = ",")` entries this season from `r n_athletes_season` athletes. 

```{r}
plotly_part_hist(dt_all_long)
```

```{r}
table_part_total(dt_all_long, tri_cols)
```

# Participation - Trends


## By Race

```{r course_totals}
dt_entry_type <- dt_all_long[(started) & part == "Swim", .(count = .N), by = course_nice]
setorder(dt_entry_type, course_nice)
dt_entry_type[, text := paste0(count, " for ", course_nice)]
```

The total number of entries by course are `r list_with_and(dt_entry_type$text)`. The plot below shows the number of entries by course over the season.

```{r}
plot_race_count(dt_all_long)
```



## By Athlete


This plot shows the cumulative number of races entered by each athlete over the season. It's a bit crowded showing everyone, each athlete's entries can be toggled by clicking (or double-clicking) their names in the legend.

```{r}
plotly_time_series(dt_all_long)
```
